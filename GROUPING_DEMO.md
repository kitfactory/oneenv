# OneEnv グループ化と重要度機能

OneEnvは環境変数をカテゴリと重要度レベルでグループ化し、生成される`.env.example`ファイルをより整理された形で出力できるようになりました。

## 新機能

### グループと重要度属性

環境変数テンプレートに以下の属性を追加できます：
- `group`: 関連する変数をまとめてグループ化
- `importance`: 重要度レベルの設定：
  - `critical`: 必須設定項目 - アプリケーションが動作するために必要
  - `important`: 重要設定項目 - 本格運用では設定すべき項目
  - `optional`: デフォルトで十分 - 必要に応じて調整する項目

### テンプレート形式

```python
from oneenv import oneenv

@oneenv
def database_template():
    return {
        "DATABASE_URL": {
            "description": "データベース接続URL",
            "default": "postgresql://localhost:5432/mydb",
            "required": True,
            "group": "Database",              # NEW: グループ名
            "importance": "critical"          # NEW: 重要度レベル
        },
        "DATABASE_POOL_SIZE": {
            "description": "データベース接続プールサイズ",
            "default": "10",
            "required": False,
            "group": "Database",
            "importance": "important"
        },
        "DATABASE_TIMEOUT": {
            "description": "データベース接続タイムアウト",
            "default": "30",
            "required": False,
            "group": "Database",
            "importance": "optional"
        }
    }

@oneenv
def web_template():
    return {
        "WEB_HOST": {
            "description": "Webサーバーホストアドレス",
            "default": "0.0.0.0",
            "required": False,
            "group": "Web Server",
            "importance": "critical"
        },
        "WEB_PORT": {
            "description": "Webサーバーポート",
            "default": "8000",
            "required": False,
            "group": "Web Server", 
            "importance": "important"
        },
        "WEB_WORKERS": {
            "description": "Webワーカー数",
            "default": "4",
            "required": False,
            "group": "Web Server",
            "importance": "optional"
        }
    }
```

### 生成される出力

新しいシステムは重要度順、そしてグループ順で変数を整理します。セクションヘッダーは言語環境に応じて表示されます：

#### 日本語環境 (LANG=ja_JP.UTF-8)
```
# Auto-generated by OneEnv

# ========== CRITICAL: 必須設定項目 ==========

# ----- Database -----

# (Defined in: database_template)
# データベース接続URL
# Required
DATABASE_URL=postgresql://localhost:5432/mydb

# ========== IMPORTANT: 重要設定項目 ==========

# ----- Database -----

# (Defined in: database_template)
# データベース接続プールサイズ
DATABASE_POOL_SIZE=10

# ========== OPTIONAL: デフォルトで十分 ==========

# ----- Database -----

# (Defined in: database_template)
# データベース接続タイムアウト
DATABASE_TIMEOUT=30
```

#### 英語環境 (LANG=en_US.UTF-8)
```
# Auto-generated by OneEnv

# ========== CRITICAL: Essential Settings for Application Operation ==========

# ----- Database -----

# (Defined in: database_template)
# Database connection URL
# Required
DATABASE_URL=postgresql://localhost:5432/mydb

# ========== IMPORTANT: Settings to Configure for Production Use ==========

# ----- Database -----

# (Defined in: database_template)
# Database connection pool size
DATABASE_POOL_SIZE=10

# ========== OPTIONAL: Fine-tuning Settings (Defaults are Sufficient) ==========

# ----- Database -----

# (Defined in: database_template)
# Database connection timeout
DATABASE_TIMEOUT=30
```

## 後方互換性

`group`と`importance`属性を持たない既存のテンプレートは変更なしで動作します：
- デフォルトグループ: "General"
- デフォルト重要度: "important"

## 利点

1. **より良い整理**: 変数が論理的にグループ化される
2. **優先度の明確化**: 重要な設定項目が最初に表示される
3. **ナビゲーションの改善**: 明確なセクションヘッダーで変数を見つけやすい
4. **互換性の維持**: 既存のテンプレートは変更なしで動作

## 重要度レベルの使い分け

### Critical（必須設定項目）
- **日本語**: 必須設定項目
- **英語**: Essential Settings for Application Operation
- **説明**: アプリケーションが起動しない、または正常に動作しない設定
- **例**: DATABASE_URL, SECRET_KEY, WEB_HOST

### Important（重要設定項目）
- **日本語**: 重要設定項目
- **英語**: Settings to Configure for Production Use
- **説明**: デフォルト値でも動作するが、本格運用では変更すべき設定
- **例**: DEBUG, LOG_LEVEL, DATABASE_POOL_SIZE

### Optional（デフォルトで十分）
- **日本語**: デフォルトで十分
- **英語**: Fine-tuning Settings (Defaults are Sufficient)
- **説明**: パフォーマンス調整や細かいカスタマイズのための設定
- **例**: TIMEOUT値, WORKER数, CACHE設定

## 多言語対応

セクションヘッダーは自動的にシステムの言語環境を検出して表示されます：

### 検出方法
1. `LANG` 環境変数をチェック
2. システムロケール設定をチェック  
3. デフォルトロケール設定をチェック

### サポート言語
- **日本語**: `ja` または `jp` を含むロケール
  - 例：`ja_JP.UTF-8`, `ja_JP.eucJP`
- **英語**: その他すべてのロケール（デフォルト）
  - 例：`en_US.UTF-8`, `fr_FR.UTF-8`, `de_DE.UTF-8`

### 手動設定
```bash
# 日本語で出力
LANG=ja_JP.UTF-8 oneenv template

# 英語で出力  
LANG=en_US.UTF-8 oneenv template
```