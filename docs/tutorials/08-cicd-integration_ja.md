# Step 8: CI/CDã¨ã®é€£æº

**æ‰€è¦æ™‚é–“:** 15-20åˆ†  
**é›£æ˜“åº¦:** ä¸­ç´šã€œä¸Šç´š

## å­¦ç¿’ç›®æ¨™

- CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ã®OneEnvæ´»ç”¨æ–¹æ³•ã‚’å­¦ã¶
- è‡ªå‹•ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆã¨æ¤œè¨¼ã®ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹
- ç¶™ç¶šçš„ãªè¨­å®šç®¡ç†ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’å®Ÿè·µã™ã‚‹
- è¤‡æ•°ã®ç’°å¢ƒã§ã®è¨­å®šç®¡ç†ã‚’è‡ªå‹•åŒ–ã™ã‚‹

## CI/CDã§ã®èª²é¡Œ

### å¾“æ¥ã®å•é¡Œ
- æ‰‹å‹•ã§ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
- ç’°å¢ƒé–“ã§ã®è¨­å®šä¸æ•´åˆ
- æ–°ã—ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ æ™‚ã®è¨­å®šæ¼ã‚Œ
- è¨­å®šå¤‰æ›´ã®è¿½è·¡å›°é›£

### OneEnvã«ã‚ˆã‚‹è§£æ±º
- è‡ªå‹•ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
- è¨­å®šã®ä¸€è²«æ€§ãƒã‚§ãƒƒã‚¯
- å¤‰æ›´ã®è‡ªå‹•æ¤œå‡º
- ç’°å¢ƒåˆ¥è¨­å®šã®æ¤œè¨¼

## å®Ÿè·µæ¼”ç¿’

### æ¼”ç¿’1: GitHub Actionsã§ã®åŸºæœ¬è¨­å®š

1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã‚’ä½œæˆï¼š
```bash
mkdir cicd-oneenv-demo
cd cicd-oneenv-demo
mkdir -p .github/workflows
```

2. ç’°å¢ƒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ¤œè¨¼ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆ`.github/workflows/env-template-check.yml`ï¼‰ï¼š

```yaml
name: Environment Template Check

on:
  pull_request:
    branches: [main, develop]
    paths:
      - 'requirements.txt'
      - 'pyproject.toml'
      - 'env/**'
      - 'src/**'
  push:
    branches: [main]

jobs:
  validate-env-template:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        cache: 'pip'
    
    - name: Install dependencies
      run: |
        pip install --upgrade pip
        pip install oneenv
        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
        if [ -f pyproject.toml ]; then pip install -e .; fi
    
    - name: Generate current template
      run: |
        echo "Generating environment template..."
        oneenv template -o .env.example.new
        
        echo "Debug output:"
        oneenv template -d
    
    - name: Check for template changes
      id: template-check
      run: |
        if [ -f .env.example ]; then
          if ! diff -q .env.example .env.example.new > /dev/null; then
            echo "template-changed=true" >> $GITHUB_OUTPUT
            echo "âŒ Environment template is outdated!"
            echo "::group::Template Differences"
            oneenv diff .env.example .env.example.new || true
            echo "::endgroup::"
          else
            echo "template-changed=false" >> $GITHUB_OUTPUT
            echo "âœ… Environment template is up to date!"
          fi
        else
          echo "template-changed=true" >> $GITHUB_OUTPUT
          echo "âš ï¸ No existing .env.example found, creating new template"
        fi
    
    - name: Validate template format
      run: |
        echo "Validating template format..."
        
        # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒé©åˆ‡ã«ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        if [ ! -f .env.example.new ]; then
          echo "âŒ Template generation failed"
          exit 1
        fi
        
        # å¿…é ˆè¨­å®šãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        if ! grep -q "Auto-generated by OneEnv" .env.example.new; then
          echo "âŒ Template header missing"
          exit 1
        fi
        
        echo "âœ… Template format is valid"
    
    - name: Check for secrets in template
      run: |
        echo "Checking for potential secrets in template..."
        
        # æ©Ÿå¯†æƒ…å ±ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯
        if grep -i "password.*=" .env.example.new | grep -v "your-password" | grep -v "password123" | grep -v "change-me"; then
          echo "âŒ Potential secrets found in template"
          exit 1
        fi
        
        if grep -i "secret.*=" .env.example.new | grep -v "your-secret" | grep -v "secret-key" | grep -v "change-me"; then
          echo "âŒ Potential secrets found in template"
          exit 1
        fi
        
        echo "âœ… No secrets detected in template"
    
    - name: Upload template artifact
      uses: actions/upload-artifact@v3
      with:
        name: env-template
        path: .env.example.new
    
    - name: Comment on PR (if template changed)
      if: github.event_name == 'pull_request' && steps.template-check.outputs.template-changed == 'true'
      uses: actions/github-script@v6
      with:
        script: |
          const fs = require('fs');
          const newTemplate = fs.readFileSync('.env.example.new', 'utf8');
          
          const comment = `## ðŸ”„ Environment Template Update Required
          
          The environment template needs to be updated due to changes in dependencies or configuration.
          
          ### Action Required
          1. Download the updated template from the workflow artifacts
          2. Replace the current \`.env.example\` with the new version
          3. Review the changes and commit the updated template
          
          ### Generated Template Preview
          \`\`\`bash
          ${newTemplate.substring(0, 1000)}${newTemplate.length > 1000 ? '...\n(truncated)' : ''}
          \`\`\`
          
          **âš ï¸ Please review the template changes before merging this PR.**`;
          
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: comment
          });
```

### æ¼”ç¿’2: è‡ªå‹•ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ›´æ–°ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

å®šæœŸçš„ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ›´æ–°ï¼ˆ`.github/workflows/auto-update-template.yml`ï¼‰ï¼š

```yaml
name: Auto-update Environment Template

on:
  schedule:
    # æ¯Žé€±æœˆæ›œæ—¥ã®åˆå‰2æ™‚ï¼ˆUTCï¼‰ã«å®Ÿè¡Œ
    - cron: '0 2 * * 1'
  workflow_dispatch:
    inputs:
      force_update:
        description: 'Force template update even if no changes'
        required: false
        default: 'false'
        type: boolean

jobs:
  update-template:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        cache: 'pip'
    
    - name: Install dependencies
      run: |
        pip install --upgrade pip
        pip install oneenv
        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
        if [ -f pyproject.toml ]; then pip install -e .; fi
    
    - name: Generate updated template
      run: |
        echo "Generating updated environment template..."
        oneenv template -o .env.example.new
        
        # ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’å‡ºåŠ›
        echo "::group::OneEnv Debug Output"
        oneenv template -d
        echo "::endgroup::"
    
    - name: Check for changes
      id: changes
      run: |
        if [ -f .env.example ]; then
          if ! diff -q .env.example .env.example.new > /dev/null; then
            echo "has-changes=true" >> $GITHUB_OUTPUT
            echo "Template changes detected"
          else
            echo "has-changes=false" >> $GITHUB_OUTPUT
            echo "No template changes"
          fi
        else
          echo "has-changes=true" >> $GITHUB_OUTPUT
          echo "No existing template found"
        fi
        
        # å¼·åˆ¶æ›´æ–°ãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆ
        if [ "${{ github.event.inputs.force_update }}" = "true" ]; then
          echo "has-changes=true" >> $GITHUB_OUTPUT
          echo "Force update requested"
        fi
    
    - name: Update template file
      if: steps.changes.outputs.has-changes == 'true'
      run: |
        mv .env.example.new .env.example
        echo "Template file updated"
    
    - name: Create Pull Request
      if: steps.changes.outputs.has-changes == 'true'
      uses: peter-evans/create-pull-request@v5
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        commit-message: "chore: update environment template"
        title: "ðŸ”„ Auto-update environment template"
        body: |
          ## ðŸ“ Automated Environment Template Update
          
          This PR contains an automated update to the environment template.
          
          ### Changes Detected
          - New or updated dependencies may have introduced new environment variables
          - OneEnv has automatically generated an updated `.env.example` file
          
          ### Review Required
          Please review the template changes to ensure:
          - âœ… No sensitive information is exposed
          - âœ… New variables have appropriate default values
          - âœ… Required variables are properly marked
          - âœ… Documentation is clear and accurate
          
          ### Testing
          - [ ] Verify template works in development environment
          - [ ] Check that all new variables are properly documented
          - [ ] Ensure no breaking changes to existing configuration
          
          ---
          *This PR was automatically created by the OneEnv template update workflow.*
        branch: chore/update-env-template
        delete-branch: true
    
    - name: Clean up
      run: |
        if [ -f .env.example.new ]; then
          rm .env.example.new
        fi
```

### æ¼”ç¿’3: ç’°å¢ƒåˆ¥ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæ¤œè¨¼

è¤‡æ•°ç’°å¢ƒå¯¾å¿œãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆ`.github/workflows/multi-env-deploy.yml`ï¼‰ï¼š

```yaml
name: Multi-Environment Deployment

on:
  push:
    branches: [main]
  release:
    types: [published]

jobs:
  validate-configurations:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        environment: [development, staging, production]
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: Install dependencies
      run: |
        pip install oneenv
        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
    
    - name: Validate environment configuration
      env:
        ENVIRONMENT: ${{ matrix.environment }}
      run: |
        echo "Validating ${{ matrix.environment }} environment..."
        
        # ç’°å¢ƒå›ºæœ‰ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        if [ -f "env/${{ matrix.environment }}/common.env" ]; then
          echo "âœ… Environment configuration found"
        else
          echo "âš ï¸ Environment configuration not found, using defaults"
        fi
        
        # è¨­å®šæ¤œè¨¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰
        if [ -f "scripts/validate_config.py" ]; then
          python scripts/validate_config.py --environment ${{ matrix.environment }}
        fi
    
    - name: Generate environment-specific template
      env:
        ENVIRONMENT: ${{ matrix.environment }}
      run: |
        # ç’°å¢ƒå›ºæœ‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆ
        oneenv template -o .env.example.${{ matrix.environment }}
        
        echo "::group::${{ matrix.environment }} Template"
        cat .env.example.${{ matrix.environment }}
        echo "::endgroup::"
    
    - name: Upload environment template
      uses: actions/upload-artifact@v3
      with:
        name: env-template-${{ matrix.environment }}
        path: .env.example.${{ matrix.environment }}

  deploy-staging:
    needs: validate-configurations
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    environment: staging
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Download staging template
      uses: actions/download-artifact@v3
      with:
        name: env-template-staging
    
    - name: Deploy to staging
      run: |
        echo "Deploying to staging environment..."
        # ã“ã“ã§å®Ÿéš›ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆå‡¦ç†ã‚’å®Ÿè¡Œ
        echo "Using template: .env.example.staging"

  deploy-production:
    needs: validate-configurations
    if: github.event_name == 'release'
    runs-on: ubuntu-latest
    environment: production
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Download production template
      uses: actions/download-artifact@v3
      with:
        name: env-template-production
    
    - name: Deploy to production
      run: |
        echo "Deploying to production environment..."
        # ã“ã“ã§å®Ÿéš›ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆå‡¦ç†ã‚’å®Ÿè¡Œ
        echo "Using template: .env.example.production"
```

### æ¼”ç¿’4: Dockerç’°å¢ƒã§ã®è¨­å®šç®¡ç†

Dockerçµ±åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆ`.github/workflows/docker-config.yml`ï¼‰ï¼š

```yaml
name: Docker Configuration Management

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  docker-config-test:
    runs-on: ubuntu-latest
    
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: postgres
          POSTGRES_DB: testdb
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v3
    
    - name: Build test image
      uses: docker/build-push-action@v5
      with:
        context: .
        file: ./Dockerfile.test
        push: false
        tags: test-app:latest
        cache-from: type=gha
        cache-to: type=gha,mode=max
    
    - name: Generate environment template in container
      run: |
        # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§OneEnvã‚’å®Ÿè¡Œ
        docker run --rm \
          -v ${{ github.workspace }}:/workspace \
          -w /workspace \
          test-app:latest \
          python -c "
        import oneenv
        import sys
        sys.path.append('/workspace')
        
        # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
        template = oneenv.template()
        with open('.env.example.docker', 'w') as f:
            f.write(template)
        
        print('âœ… Docker template generated successfully')
        "
    
    - name: Test configuration loading
      run: |
        # Dockerç’°å¢ƒã§ã®è¨­å®šèª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ
        docker run --rm \
          -v ${{ github.workspace }}:/workspace \
          -w /workspace \
          -e DATABASE_URL=postgresql://postgres:postgres@postgres:5432/testdb \
          test-app:latest \
          python -c "
        import oneenv
        import os
        
        # ç’°å¢ƒå¤‰æ•°ã‚’ãƒ­ãƒ¼ãƒ‰
        oneenv.load_dotenv('.env.example.docker')
        
        # è¨­å®šå€¤ã‚’ãƒ†ã‚¹ãƒˆ
        db_url = os.getenv('DATABASE_URL')
        print(f'Database URL: {db_url}')
        
        if db_url:
            print('âœ… Configuration loaded successfully')
        else:
            print('âŒ Configuration loading failed')
            exit(1)
        "
    
    - name: Upload Docker template
      uses: actions/upload-artifact@v3
      with:
        name: docker-env-template
        path: .env.example.docker
```

### æ¼”ç¿’5: è¨­å®šç›£æŸ»ã¨ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹

è¨­å®šç›£æŸ»ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆ`.github/workflows/config-audit.yml`ï¼‰ï¼š

```yaml
name: Configuration Audit

on:
  schedule:
    # æ¯Žæ—¥åˆå‰3æ™‚ï¼ˆUTCï¼‰ã«å®Ÿè¡Œ
    - cron: '0 3 * * *'
  workflow_dispatch:

jobs:
  security-audit:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: Install dependencies
      run: |
        pip install oneenv
        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
    
    - name: Run security audit
      run: |
        # è¨­å®šç›£æŸ»ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ
        cat > audit_config.py << 'EOF'
        import oneenv
        import re
        import sys
        from datetime import datetime
        
        def audit_template():
            """ç’°å¢ƒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»"""
            print(f"ðŸ” Configuration Audit - {datetime.now().isoformat()}")
            print("=" * 60)
            
            # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
            template = oneenv.template()
            
            errors = []
            warnings = []
            
            # æ©Ÿå¯†æƒ…å ±ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯
            secret_patterns = [
                r'password.*=.*[^\\s].*[^example].*[^change]',
                r'secret.*=.*[^\\s].*[^key].*[^change]',
                r'token.*=.*[^\\s].*[^your].*[^change]',
                r'api[_-]?key.*=.*[^\\s].*[^your].*[^change]'
            ]
            
            for pattern in secret_patterns:
                matches = re.findall(pattern, template, re.IGNORECASE)
                if matches:
                    errors.append(f"Potential secret found: {matches}")
            
            # ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã®ç¢ºèª
            if 'DEBUG=True' in template or 'DEBUG=true' in template:
                warnings.append("DEBUG mode is enabled")
            
            # HTTPSå¼·åˆ¶ã®ç¢ºèª
            if 'FORCE_HTTPS=False' in template:
                warnings.append("HTTPS enforcement is disabled")
            
            # çµæžœå‡ºåŠ›
            if errors:
                print("ðŸ”´ SECURITY ERRORS:")
                for error in errors:
                    print(f"  - {error}")
                print()
            
            if warnings:
                print("ðŸŸ¡ SECURITY WARNINGS:")
                for warning in warnings:
                    print(f"  - {warning}")
                print()
            
            if not errors and not warnings:
                print("âœ… No security issues detected")
            
            return len(errors) == 0
        
        # ç›£æŸ»å®Ÿè¡Œ
        success = audit_template()
        if not success:
            sys.exit(1)
        EOF
        
        python audit_config.py
    
    - name: Check template freshness
      run: |
        # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æœ€çµ‚æ›´æ–°æ—¥ã‚’ãƒã‚§ãƒƒã‚¯
        if [ -f .env.example ]; then
          last_modified=$(stat -c %Y .env.example)
          current_time=$(date +%s)
          days_old=$(( (current_time - last_modified) / 86400 ))
          
          echo "Template age: $days_old days"
          
          if [ $days_old -gt 30 ]; then
            echo "âš ï¸ Template is older than 30 days"
            echo "Consider running template update workflow"
          else
            echo "âœ… Template is recent"
          fi
        else
          echo "âŒ No .env.example file found"
          exit 1
        fi
    
    - name: Generate audit report
      run: |
        # ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ
        cat > audit_report.md << EOF
        # Configuration Audit Report
        
        **Date**: $(date)
        **Repository**: ${{ github.repository }}
        **Commit**: ${{ github.sha }}
        
        ## Template Status
        $(if [ -f .env.example ]; then echo "âœ… Template exists"; else echo "âŒ Template missing"; fi)
        
        ## Security Checks
        - Secret detection: Completed
        - Debug mode check: Completed
        - HTTPS enforcement check: Completed
        
        ## Recommendations
        - Keep templates updated regularly
        - Review configuration changes during PR reviews
        - Use environment-specific overrides for sensitive values
        
        EOF
        
        cat audit_report.md
    
    - name: Upload audit report
      uses: actions/upload-artifact@v3
      with:
        name: config-audit-report
        path: audit_report.md
```

## CI/CDãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. **è‡ªå‹•åŒ–ãƒ¬ãƒ™ãƒ«**
```yaml
# ãƒ¬ãƒ™ãƒ«1: åŸºæœ¬æ¤œè¨¼
- è¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ç”Ÿæˆç¢ºèª
- ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆæ¤œè¨¼

# ãƒ¬ãƒ™ãƒ«2: å¤‰æ›´æ¤œå‡º
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå·®åˆ†ã®è‡ªå‹•æ¤œå‡º
- PRã§ã®å¤‰æ›´é€šçŸ¥

# ãƒ¬ãƒ™ãƒ«3: è‡ªå‹•æ›´æ–°
- å®šæœŸçš„ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ›´æ–°
- è‡ªå‹•PRä½œæˆ

# ãƒ¬ãƒ™ãƒ«4: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»
- æ©Ÿå¯†æƒ…å ±ã‚¹ã‚­ãƒ£ãƒ³
- è¨­å®šã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯
```

### 2. **ç’°å¢ƒåˆ†é›¢**
```yaml
# ç’°å¢ƒã”ã¨ã®è¨­å®šæ¤œè¨¼
strategy:
  matrix:
    environment: [dev, staging, prod]
```

### 3. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
```yaml
# è¨­å®šæ¤œè¨¼å¤±æ•—æ™‚ã®å‡¦ç†
- name: Notify on failure
  if: failure()
  uses: slack-action
```

### 4. **ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆç®¡ç†**
```yaml
# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä¿å­˜ã¨å…±æœ‰
uses: actions/upload-artifact@v3
with:
  name: env-templates
  retention-days: 30
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

1. **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆå¤±æ•—**
```bash
# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§ç¢ºèª
oneenv template -d
```

2. **ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒç™ºè¦‹ã•ã‚Œãªã„**
```bash
# ä¾å­˜é–¢ä¿‚ã®ç¢ºèª
pip list | grep oneenv
```

3. **è¨­å®šæ¤œè¨¼ã‚¨ãƒ©ãƒ¼**
```bash
# ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª
env | grep ENVIRONMENT
```

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

CI/CDé€£æºã‚’å­¦ç¿’å®Œäº†ã—ã¾ã—ãŸã€‚ã“ã‚Œã§OneEnvã®å…¨æ©Ÿèƒ½ã‚’ç¿’å¾—ã—ã€å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ´»ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

**â†’ [ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«å®Œäº†](README.md)**

### ç¶™ç¶šå­¦ç¿’ã®ãŸã‚ã«

1. **å®Ÿãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®æ´»ç”¨**
2. **ãƒãƒ¼ãƒ å†…ã§ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹å…±æœ‰**
3. **OneEnv ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®é–‹ç™ºã¨å…¬é–‹**
4. **ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã®è²¢çŒ®**

## ã‚ˆãã‚ã‚‹è³ªå•

### Q: CI/CDã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”ŸæˆãŒå¤±æ•—ã™ã‚‹å ´åˆã¯ï¼Ÿ
A: ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«é †åºã¨ç’°å¢ƒå¤‰æ•°ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

### Q: å¤§ããªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒé…ã„å ´åˆã¯ï¼Ÿ
A: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨ã¨ä¸¦åˆ—å®Ÿè¡Œã‚’æ¤œè¨Žã—ã¦ãã ã•ã„ã€‚

### Q: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ã§èª¤æ¤œå‡ºãŒç™ºç”Ÿã™ã‚‹å ´åˆã¯ï¼Ÿ
A: ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒžãƒƒãƒãƒ³ã‚°ã®ãƒ«ãƒ¼ãƒ«ã‚’èª¿æ•´ã—ã€ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã‚’æ´»ç”¨ã—ã¦ãã ã•ã„ã€‚

### Q: è¤‡æ•°ã®ç’°å¢ƒã§è¨­å®šãŒç«¶åˆã™ã‚‹å ´åˆã¯ï¼Ÿ
A: ç’°å¢ƒå›ºæœ‰ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¨å„ªå…ˆåº¦ã‚’æ˜Žç¢ºã«å®šç¾©ã—ã¦ãã ã•ã„ã€‚